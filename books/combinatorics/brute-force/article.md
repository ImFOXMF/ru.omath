## Зачем это нужно?

Очень многие комбинаторные задачи можно решить просто вручную составив все возможные комбинации.

* Зачем вообще проходить эту тему?
* Перебрать варианты любой ведь сможет!
* Мы ведь и зашли в этот учебник, чтобы изучать приемы быстрого решения!

Эти и подобные вопросы и возмущения понятны.

Чтобы научиться летать, нужно сначала научиться ползать.
Любую комбинаторную задачу можно решить

## Перебираем с умом

Казалось бы, что может быть проще!?
Просто берешь и выписываешь все возможные комбинации!
Как-бы да, но при бездумном и бессистемном выписывании высока вероятность пропустить какую-то комбинацию.
Или посчитать одну и ту же дважды.

Чтобы такого не проиходило, нужно придерживаться двух простых правил:

{ #brute-force-rules }
@important
    title: Правила перебора
    content: |
        1. Каждому элементу дать уникальное обозначение.
        2. Придумать удобный алгоритм перебора и строго ему следовать.

Уникальные обозначения элементам нужно давать, чтобы не держать в голове сложные сущности. Превратить их в что-то простое -- буквы или символы.
Алгоритм перебора позволит не запутаться, не пропустить комбинации и не посчитать лишние.

Разберем несолько простых примеров, иллюстрирующих это правило.

@example
    title: Насыщенный день
    task: |
        Петр должен убраться в комнате, сделать домашнее задание и поработать над личным проектом.
        Сделать нужно все, но Петр еще не решил, в какой последовательности.
        Сколькими способами он может выбрать эту последовательность?
    solution: |
        Обозначим уборку в комнате буквой "У", домашнее задание буквой "Д", а работу над личным проектом буквой "П".
        Введя эти обозначения мы выполнили первый пункт [правил перебора](i:brute-force-rules).

        Перебирать будем так: сначала разберем варианты, когда буква "У" стоит первой, потом второй, затем последней.
        Введя такой порядок мы выполнили второй пункт правил перебора.
        Приступаем:

        @math
            \bm{У}\text{ДП} \quad \bm{У}\text{ПД}
            \\
            \text{Д}\bm{У}\text{П} \quad \text{П}\bm{У}\text{Д}
            \\
            \text{ДП}\bm{У} \quad \text{ПД}\bm{У}
        
        Всего $6$ способов распланировать $3$ дела на день.

        ---

        Предложенный выше алгоритм через фиксацию буквы может подойти не всем.
        Кому-то удобнее записывать варианты в алфавитном порядке.
        Делайте так, как удобно вам. Главное -- **строго придерживайтесь** выбранного алгоритма!

В некоторых задачах предстоит работать с числами и цифрами.
Они и так записываются коротко и хорошо друг от друга отличаются.
Поэтому им, обычно, не нужно придумывать уникальные обозначения и первое [правило перебора](i:brute-force-rules) можно считать автоматически выполненным.

@example
    title: В поисках чисел
    task: |
        Сколько существует четырехзначных чисел, сумма цифр которых меньше $4$?
    solution: |
        Уникальные обозначения вводить не надо, но все еще нужно выполнить второе правило перебора: придумать удобный алгоритм.

        Чтобы не запутаться, не потерять и лишний раз не засчитать числа, будем указывать их в **порядке возрастания**: от маленьких к большим.
        И помним, что сумма цифр в числе должна быть меньше $4$, то есть равна $1$, $2$ или $3$.

        @math
            1000, \
            1001, \
            1002, \
            1010, \
            1011, \
            1020, \
            1100, \
            1101, \
            1110, \
            1200, \\
            2000, \
            2001, \
            2010, \
            2100, \\
            3000

Будем честны, предыдущие примеры вполне можно было решить без всяких правил, просто наобум перебирая дела и числа.
Рассмотрим теперь пример задачи, которую без правил уже не взять.

@example
    title: Задача Эйлера о шляпах
    task: |
        Ресторан посетили $4$ человека. Свои шляпы они отдали швейцару.
        На выходе невнимательный швейцар раздал шляпы случайным образом.
        Сколько существует вариантов, когда каждый гость получил чужую шляпу?
    solution: |
        Дадим каждому человеку свой номер от $1$ до $4$.
        Шляпы тоже пронумируем так, чтобы номер каждой шляпы совпадал с номером ее владельца.

        Дальше нужно придумать, как удобно обозначать варианты выдачи шляп.
        Будем записывать их в виде набора из четырех цифр, причем позиция цифры означает человека, а сама цифра номер шляпы.
        Например, набор $1234$ означает, что каждый человек получил свою шляпу.
        А набор $1243$ означает, что третий человек получил шляпу четвертого, а четвертый шляпу третьего:

        $$ \overset{1\text{ч}}{1} \ \overset{2\text{ч}}{2} \ \overset{3\text{ч}}{4} \ \overset{4\text{ч}}{3} $$

        Мы свели задачу к тому, что нужно просто найти все наборы из четырех цифр, в которых **позиция каждой цифры не равна самой цифре**.

        Введя подобные обозначения, мы выполнили первое [правило](i:brute-force-rules) прямого перебора.
        Но как не запутаться и перечислить все такие наборы цифр?
        Для этого надо придумать грамотный алгоритм перебора ($2$-е правило перебора).

        Построим таблицу, в верхней строчке которой укажем номера гостей.
        Потом добавляем строки с четырехзначными числами в **порядке возрастания**. Следим за тем, чтобы номер шляпы не совпал с номером человека.
        Такие варианты вычеркиваем:

        @math
            \def\arraystretch{1.5}
            \begin{array}{cccc}
                1\text{ч} & 2\text{ч} & 3\text{ч} & 4\text{ч} \\ \hline 
                \color{red} 2 & \color{red} 1 & \color{red} 3 & \fcolorbox{red}{transparent}{\color{red}4} \\
                2 & 1 & 4 & 3 \\
                \color{red} 2 & \color{red} 3 & \color{red} 1 & \fcolorbox{red}{transparent}{\color{red}4} \\
                2 & 3 & 4 & 1 \\
                2 & 4 & 1 & 3 \\
                \color{red} 2 & \color{red} 4 & \fcolorbox{red}{transparent}{\color{red}3} & \color{red} 1
            \end{array}

        Красным цветом помечены неподходящие варианты.
        В красную рамочку взяты номера шляп, которые попали в руки своих владельцев.

        Продолжаем в том же духе.
        В итоге, после вычеркивания всех лишних наборов останется что-то такое:

        @math
            \def\arraystretch{1.5}
            \begin{array}{cccc}
                1\text{ч} & 2\text{ч} & 3\text{ч} & 4\text{ч} \\ \hline 
                2 & 1 & 4 & 3 \\
                2 & 3 & 4 & 1 \\
                2 & 4 & 1 & 3 \\ \hline
                3 & 1 & 4 & 2 \\
                3 & 4 & 1 & 2 \\
                3 & 4 & 2 & 1 \\ \hline
                4 & 1 & 2 & 3 \\
                4 & 3 & 1 & 2 \\
                4 & 3 & 2 & 1
            \end{array}
    
        Получается, есть $9$ вариантов, когда каждый гость получил чужую шляпу.

Заметили, что самое сложное в таких задачах -- как раз таки выполнить два правила: ввести обознчания и придумать алгоритм?
Но когда оба пункта правил выполнены думать уже не надо, остается только аккуратно и внимательно перебирать варианты.
Из всего этого следует довольно простой вывод:

@important
    content: |
        Если соблюдать [правила перебора](i:brute-force-rules) (удобные обозначения и алгоритм перебора), то многие комбинаторные задачи можно решить полным перебором.
        Будет долго, но ответ все равно будет получен.

## Дерево вариантов

Сбор команды корабля.